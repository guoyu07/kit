#!/bin/bash
#------------------------------------------------
# target: vars on bash environment
# author: junjiemars@gmail.com
#------------------------------------------------

PLATFORM=`uname -s 2>/dev/null`

case "${PLATFORM}" in
  MSYS_NT*)
    if [ -d "/d/" ]; then
      PREFIX=${PREFIX:-"/d/opt"}
    else
      PREFIX=${PREFIX:-"/c/opt"}
    fi
    ;;
  *)
    PREFIX=${PREFIX:-"/opt"}
    ;;
esac

OPT_RUN="${PREFIX}/run"
OPT_OPEN="${PREFIX}/open"


opt_basis_dirs() {
  [ -d "${OPT_RUN}" ] && export OPT_RUN=${OPT_RUN}
  [ -d "${OPT_OPEN}" ] && export OPT_OPEN=${OPT_OPEN}
}

check_java() {
  case "${PLATFORM}" in
    Darwin)
      local java_home='/usr/libexec/java_home'
      [ -L ${java_home} ] && export JAVA_HOME=`${java_home}`
      ;;
    Linux)
      local javac=`type -p javac 2>/dev/null`
      [ -n "${javac}" ] && \
        local java_home=$(readlink -f "${javac}" | sed 's:/bin/javac::')
      [ -n "${java_home}" ] && export JAVA_HOME="${java_home}"
      ;; 
    MSYS_NT*)
      ;;
    *)
      ;;
  esac
}

check_term() {
  if [ -z "$TERM" ] || [ "dumb" == "$TERM" ]; then
    export TERM="xterm"
  fi
}

opt_basis_dirs

check_java

check_term

# declare vars
